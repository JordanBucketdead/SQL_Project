CREATE TABLE PRODUS(
    MODEL INT NOT NULL,
    FABRICANT VARCHAR(30) NOT NULL,
    CATEGORIE VARCHAR(10) NOT NULL,
    PRET DECIMAL(10,2) NOT NULL
);


CREATE TABLE PC(
    MODEL INT NOT NULL,
    VITEZA INT NOT NULL,
    RAM INT NOT NULL,
    HD INT NOT NULL
);


CREATE TABLE LAPTOP(
    MODEL INT NOT NULL,
    VITEZA INT NOT NULL,
    RAM INT NOT NULL,
    HD INT NOT NULL,
    ECRAN INT NOT NULL
);


CREATE TABLE IMPRIMANTA(
    MODEL INT NOT NULL,
    CULOARE VARCHAR(2) NOT NULL,
    TIP VARCHAR(10) NOT NULL
);

ALTER TABLE PRODUS 
ADD PRIMARY KEY (MODEL);

ALTER TABLE PC
ADD PRIMARY KEY (MODEL);

ALTER TABLE LAPTOP
ADD PRIMARY KEY (MODEL);

ALTER TABLE IMPRIMANTA
ADD PRIMARY KEY (MODEL);

ALTER TABLE PC
ADD CONSTRAINT FK_PC_PRODUS
FOREIGN KEY (MODEL)
REFERENCES PRODUS(MODEL);

ALTER TABLE LAPTOP
ADD CONSTRAINT FK_LAPTOP_PRODUS
FOREIGN KEY (MODEL)
REFERENCES PRODUS(MODEL);

ALTER TABLE IMPRIMANTA
ADD CONSTRAINT FK_IMPRIMANTA_PRODUS
FOREIGN KEY (MODEL)
REFERENCES PRODUS(MODEL);

ALTER TABLE PRODUS
ADD COLUMN MONEDA VARCHAR(5);

ALTER TABLE PRODUS
MODIFY COLUMN MONEDA VARCHAR(5) NOT NULL;

INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1001, 'Dell', 'LAPTOP', 1200, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1002, 'HP', 'PC', 800, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1003, 'Apple', 'LAPTOP', 1500, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1004, 'Lenovo', 'LAPTOP', 1000, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1005, 'Asus', 'PC', 900, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1006, 'Epson', 'IMPRIMANTA', 200, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1007, 'Acer', 'LAPTOP', 1100, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1008, 'HP', 'IMPRIMANTA', 120, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1009, 'Dell', 'PC', 750, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1010, 'Canon', 'IMPRIMANTA', 180, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1011, 'Samsung', 'LAPTOP', 1300, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1012, 'Microsoft', 'LAPTOP', 1600, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1013, 'Dell', 'PC', 850, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1014, 'Lenovo', 'LAPTOP', 1200, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1015, 'Acer', 'PC', 950, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1016, 'Epson', 'IMPRIMANTA', 180, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1017, 'Asus', 'LAPTOP', 1150, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1018, 'HP', 'IMPRIMANTA', 150, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1019, 'Apple', 'LAPTOP', 1800, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1020, 'Dell', 'IMPRIMANTA', 220, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1021, 'Lenovo', 'LAPTOP', 1200, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1022, 'Acer', 'PC', 980, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1023, 'Epson', 'IMPRIMANTA', 190, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1024, 'Asus', 'LAPTOP', 1180, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1025, 'HP', 'IMPRIMANTA', 160, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1026, 'Apple', 'LAPTOP', 1900, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1027, 'Dell', 'IMPRIMANTA', 230, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1028, 'Lenovo', 'LAPTOP', 1250, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1029, 'Acer', 'PC', 1000, 'EUR');
INSERT INTO PRODUS (MODEL, FABRICANT, CATEGORIE, PRET, MONEDA)
VALUES (1030, 'Epson', 'IMPRIMANTA', 200, 'EUR');

INSERT INTO PC (MODEL, VITEZA, RAM, HD)
VALUES (1002, 2.6, 8, 1000);
INSERT INTO PC (MODEL, VITEZA, RAM, HD)
VALUES (1005, 2.0, 4, 1000);
INSERT INTO PC (MODEL, VITEZA, RAM, HD)
VALUES (1009, 3.0, 8, 1500);
INSERT INTO PC (MODEL, VITEZA, RAM, HD)
VALUES (1013, 3.2, 16, 2000);
INSERT INTO PC (MODEL, VITEZA, RAM, HD)
VALUES (1015, 2.4, 16, 750);
INSERT INTO PC (MODEL, VITEZA, RAM, HD)
VALUES (1022, 3.5, 16, 2000);
INSERT INTO PC (MODEL, VITEZA, RAM, HD)
VALUES (1029, 2.4, 8, 750);

INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1001, 2.2, 8, 512, 15.6);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1003, 2.2, 8, 512, 15.6);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1004, 2.8, 16, 1024, 14.0);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1007, 2.4, 8, 256, 13.3);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1011, 2.6, 12, 512, 17.3);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1012, 2.8, 16, 1024, 14.0);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1014, 2.4, 8, 256, 13.3);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1017,  2.6, 12, 512, 17.3);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1019,  2.0, 16, 512, 15.6);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1021, 2.8, 16, 1024, 14.0);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1024, 2.8, 16, 1024, 14.0);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1026, 2.6, 12, 512, 17.3);
INSERT INTO LAPTOP (MODEL, VITEZA, RAM, HD, ECRAN)
VALUES (1028, 2.4, 8, 256, 13.3);

INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1006, 'D', 'laser');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1008, 'N', 'ace');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1010, 'D', 'jet');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1016, 'N', 'laser');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1018, 'D', 'ace');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1020, 'N', 'jet');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1023, 'N', 'laser');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1025, 'N', 'ace');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1027, 'D', 'laser');
INSERT INTO IMPRIMANTA (MODEL, CULOARE, TIP)
VALUES (1030, 'D', 'jet');

ALTER TABLE PRODUS
ADD CONSTRAINT CHK_PRET_RANGE CHECK (PRET BETWEEN 10 AND 3000);

ALTER TABLE PC
ADD CONSTRAINT CHK_VITEZA_HD CHECK (VITEZA > 1.8 AND HD > 500);


SELECT *
FROM IMPRIMANTA
WHERE CULOARE = 'D' 
ORDER BY TIP ASC;


SELECT *
FROM LAPTOP
WHERE ECRAN = 5.6
ORDER BY VITEZA DESC, HD DESC;


SELECT i.MODEL, p.FABRICANT, p.PRET
FROM IMPRIMANTA i
JOIN PRODUS p ON i.MODEL = p.MODEL
WHERE i.TIP = 'laser' AND i.CULOARE = 'D'
ORDER BY p.PRET ASC;


SELECT
   P1.MODEL AS Model1,
   P2.MODEL AS Model2,
   P1.FABRICANT
FROM PRODUS P1
JOIN PRODUS P2 ON P1.FABRICANT = P2.FABRICANT
WHERE P1.CATEGORIE = 'PC' AND P2.CATEGORIE = 'PC' AND P1.MODEL < P2.MODEL;


SELECT DISTINCT FABRICANT
FROM PRODUS
WHERE CATEGORIE = 'LAPTOP'
  AND PRET >= ALL (
    SELECT PRET
    FROM PRODUS
    WHERE CATEGORIE = 'LAPTOP'
);


SELECT MODEL, CULOARE, TIP
FROM IMPRIMANTA I
WHERE EXISTS (
    SELECT *
    FROM PRODUS P
    WHERE P.MODEL = 123 AND P.PRET = (SELECT PRET FROM PRODUS WHERE MODEL = I.MODEL)
);


SELECT MODEL, MIN(PRET) AS PRET_MINIM
FROM PRODUS
WHERE MODEL IN (SELECT MODEL FROM PC)
GROUP BY MODEL
ORDER BY PRET_MINIM ASC;


SELECT I.TIP, AVG(P.PRET) AS PRET_MEDIU
FROM IMPRIMANTA I
JOIN PRODUS P ON I.MODEL = P.MODEL
GROUP BY I.TIP;





